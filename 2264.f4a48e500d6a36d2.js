"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2264],{76:(rt,F,b)=>{b.d(F,{GW:()=>y,dk:()=>w,oK:()=>l});var l=(()=>{return(A=l||(l={})).Prompt="PROMPT",A.Camera="CAMERA",A.Photos="PHOTOS",l;var A})(),y=(()=>{return(A=y||(y={})).Rear="REAR",A.Front="FRONT",y;var A})(),w=(()=>{return(A=w||(w={})).Uri="uri",A.Base64="base64",A.DataUrl="dataUrl",w;var A})()},7423:(rt,F,b)=>{b.d(F,{Uw:()=>O,fo:()=>c,xz:()=>N});var l=b(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var t=(()=>{return(s=t||(t={})).Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE",t;var s})();class N extends Error{constructor(r,i,g){super(r),this.message=r,this.code=i,this.data=g}}const M=s=>{var r,i,g,h,d;const T=s.CapacitorCustomPlatform||null,m=s.Capacitor||{},C=m.Plugins=m.Plugins||{},P=s.CapacitorPlatforms,q=(null===(r=null==P?void 0:P.currentPlatform)||void 0===r?void 0:r.getPlatform)||(()=>null!==T?T.name:(s=>{var r,i;return null!=s&&s.androidBridge?"android":null!==(i=null===(r=null==s?void 0:s.webkit)||void 0===r?void 0:r.messageHandlers)&&void 0!==i&&i.bridge?"ios":"web"})(s)),o=(null===(i=null==P?void 0:P.currentPlatform)||void 0===i?void 0:i.isNativePlatform)||(()=>"web"!==q()),e=(null===(g=null==P?void 0:P.currentPlatform)||void 0===g?void 0:g.isPluginAvailable)||(Z=>{const I=B.get(Z);return!!(null!=I&&I.platforms.has(q())||a(Z))}),a=(null===(h=null==P?void 0:P.currentPlatform)||void 0===h?void 0:h.getPluginHeader)||(Z=>{var I;return null===(I=m.PluginHeaders)||void 0===I?void 0:I.find(Y=>Y.name===Z)}),B=new Map,V=(null===(d=null==P?void 0:P.currentPlatform)||void 0===d?void 0:d.registerPlugin)||((Z,I={})=>{const Y=B.get(Z);if(Y)return console.warn(`Capacitor plugin "${Z}" already registered. Cannot register plugins twice.`),Y.proxy;const z=q(),K=a(Z);let L;const bt=function(){var E=(0,l.Z)(function*(){return!L&&z in I?L=L="function"==typeof I[z]?yield I[z]():I[z]:null!==T&&!L&&"web"in I&&(L=L="function"==typeof I.web?yield I.web():I.web),L});return function(){return E.apply(this,arguments)}}(),ut=E=>{let U;const S=(...G)=>{const j=bt().then(J=>{const H=((E,U)=>{var S,G;if(!K){if(E)return null===(G=E[U])||void 0===G?void 0:G.bind(E);throw new N(`"${Z}" plugin is not implemented on ${z}`,t.Unimplemented)}{const j=null==K?void 0:K.methods.find(J=>U===J.name);if(j)return"promise"===j.rtype?J=>m.nativePromise(Z,U.toString(),J):(J,H)=>m.nativeCallback(Z,U.toString(),J,H);if(E)return null===(S=E[U])||void 0===S?void 0:S.bind(E)}})(J,E);if(H){const nt=H(...G);return U=null==nt?void 0:nt.remove,nt}throw new N(`"${Z}.${E}()" is not implemented on ${z}`,t.Unimplemented)});return"addListener"===E&&(j.remove=(0,l.Z)(function*(){return U()})),j};return S.toString=()=>`${E.toString()}() { [capacitor code] }`,Object.defineProperty(S,"name",{value:E,writable:!1,configurable:!1}),S},ht=ut("addListener"),pt=ut("removeListener"),kt=(E,U)=>{const S=ht({eventName:E},U),G=function(){var J=(0,l.Z)(function*(){const H=yield S;pt({eventName:E,callbackId:H},U)});return function(){return J.apply(this,arguments)}}(),j=new Promise(J=>S.then(()=>J({remove:G})));return j.remove=(0,l.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield G()}),j},gt=new Proxy({},{get(E,U){switch(U){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return K?kt:ht;case"removeListener":return pt;default:return ut(U)}}});return C[Z]=gt,B.set(Z,{name:Z,proxy:gt,platforms:new Set([...Object.keys(I),...K?[z]:[]])}),gt});return m.convertFileSrc||(m.convertFileSrc=Z=>Z),m.getPlatform=q,m.handleError=Z=>s.console.error(Z),m.isNativePlatform=o,m.isPluginAvailable=e,m.pluginMethodNoop=(Z,I,Y)=>Promise.reject(`${Y} does not have an implementation of "${I}".`),m.registerPlugin=V,m.Exception=N,m.DEBUG=!!m.DEBUG,m.isLoggingEnabled=!!m.isLoggingEnabled,m.platform=m.getPlatform(),m.isNative=m.isNativePlatform(),m},f=(s=>s.Capacitor=M(s))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),c=f.registerPlugin;class O{constructor(r){this.listeners={},this.windowListeners={},r&&(console.warn(`Capacitor WebPlugin "${r.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=r)}addListener(r,i){var g=this;this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(i);const d=this.windowListeners[r];d&&!d.registered&&this.addWindowListener(d);const T=function(){var C=(0,l.Z)(function*(){return g.removeListener(r,i)});return function(){return C.apply(this,arguments)}}(),m=Promise.resolve({remove:T});return Object.defineProperty(m,"remove",{value:(C=(0,l.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield T()}),function(){return C.apply(this,arguments)})}),m;var C}removeAllListeners(){var r=this;return(0,l.Z)(function*(){r.listeners={};for(const i in r.windowListeners)r.removeWindowListener(r.windowListeners[i]);r.windowListeners={}})()}notifyListeners(r,i){const g=this.listeners[r];g&&g.forEach(h=>h(i))}hasListeners(r){return!!this.listeners[r].length}registerWindowListener(r,i){this.windowListeners[i]={registered:!1,windowEventName:r,pluginEventName:i,handler:g=>{this.notifyListeners(i,g)}}}unimplemented(r="not implemented"){return new f.Exception(r,t.Unimplemented)}unavailable(r="not available"){return new f.Exception(r,t.Unavailable)}removeListener(r,i){var g=this;return(0,l.Z)(function*(){const h=g.listeners[r];if(!h)return;const d=h.indexOf(i);g.listeners[r].splice(d,1),g.listeners[r].length||g.removeWindowListener(g.windowListeners[r])})()}addWindowListener(r){window.addEventListener(r.windowEventName,r.handler),r.registered=!0}removeWindowListener(r){r&&(window.removeEventListener(r.windowEventName,r.handler),r.registered=!1)}}const tt=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),et=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class ot extends O{getCookies(){return(0,l.Z)(function*(){const r=document.cookie,i={};return r.split(";").forEach(g=>{if(g.length<=0)return;let[h,d]=g.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");h=et(h).trim(),d=et(d).trim(),i[h]=d}),i})()}setCookie(r){return(0,l.Z)(function*(){try{const i=tt(r.key),g=tt(r.value),h=`; expires=${(r.expires||"").replace("expires=","")}`,d=(r.path||"/").replace("path=",""),T=null!=r.url&&r.url.length>0?`domain=${r.url}`:"";document.cookie=`${i}=${g||""}${h}; path=${d}; ${T};`}catch(i){return Promise.reject(i)}})()}deleteCookie(r){return(0,l.Z)(function*(){try{document.cookie=`${r.key}=; Max-Age=0`}catch(i){return Promise.reject(i)}})()}clearCookies(){return(0,l.Z)(function*(){try{const r=document.cookie.split(";")||[];for(const i of r)document.cookie=i.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(r){return Promise.reject(r)}})()}clearAllCookies(){var r=this;return(0,l.Z)(function*(){try{yield r.clearCookies()}catch(i){return Promise.reject(i)}})()}}c("CapacitorCookies",{web:()=>new ot});const it=function(){var s=(0,l.Z)(function*(r){return new Promise((i,g)=>{const h=new FileReader;h.onload=()=>{const d=h.result;i(d.indexOf(",")>=0?d.split(",")[1]:d)},h.onerror=d=>g(d),h.readAsDataURL(r)})});return function(i){return s.apply(this,arguments)}}();class lt extends O{request(r){return(0,l.Z)(function*(){const i=((s,r={})=>{const i=Object.assign({method:s.method||"GET",headers:s.headers},r),h=((s={})=>{const r=Object.keys(s);return Object.keys(s).map(h=>h.toLocaleLowerCase()).reduce((h,d,T)=>(h[d]=s[r[T]],h),{})})(s.headers)["content-type"]||"";if("string"==typeof s.data)i.body=s.data;else if(h.includes("application/x-www-form-urlencoded")){const d=new URLSearchParams;for(const[T,m]of Object.entries(s.data||{}))d.set(T,m);i.body=d.toString()}else if(h.includes("multipart/form-data")){const d=new FormData;if(s.data instanceof FormData)s.data.forEach((m,C)=>{d.append(C,m)});else for(const m of Object.keys(s.data))d.append(m,s.data[m]);i.body=d;const T=new Headers(i.headers);T.delete("content-type"),i.headers=T}else(h.includes("application/json")||"object"==typeof s.data)&&(i.body=JSON.stringify(s.data));return i})(r,r.webFetchExtra),g=((s,r=!0)=>s?Object.entries(s).reduce((g,h)=>{const[d,T]=h;let m,C;return Array.isArray(T)?(C="",T.forEach(P=>{m=r?encodeURIComponent(P):P,C+=`${d}=${m}&`}),C.slice(0,-1)):(m=r?encodeURIComponent(T):T,C=`${d}=${m}`),`${g}&${C}`},"").substr(1):null)(r.params,r.shouldEncodeUrlParams),h=g?`${r.url}?${g}`:r.url,d=yield fetch(h,i),T=d.headers.get("content-type")||"";let C,P,{responseType:m="text"}=d.ok?r:{};switch(T.includes("application/json")&&(m="json"),m){case"arraybuffer":case"blob":P=yield d.blob(),C=yield it(P);break;case"json":C=yield d.json();break;default:C=yield d.text()}const $={};return d.headers.forEach((q,D)=>{$[D]=q}),{data:C,headers:$,status:d.status,url:d.url}})()}get(r){var i=this;return(0,l.Z)(function*(){return i.request(Object.assign(Object.assign({},r),{method:"GET"}))})()}post(r){var i=this;return(0,l.Z)(function*(){return i.request(Object.assign(Object.assign({},r),{method:"POST"}))})()}put(r){var i=this;return(0,l.Z)(function*(){return i.request(Object.assign(Object.assign({},r),{method:"PUT"}))})()}patch(r){var i=this;return(0,l.Z)(function*(){return i.request(Object.assign(Object.assign({},r),{method:"PATCH"}))})()}delete(r){var i=this;return(0,l.Z)(function*(){return i.request(Object.assign(Object.assign({},r),{method:"DELETE"}))})()}}c("CapacitorHttp",{web:()=>new lt})},2264:(rt,F,b)=>{b.r(F),b.d(F,{routes:()=>D});var l=b(5861),y=b(6895),w=b(433),A=b(1194),v=b(650);class X{constructor(p,e,n){this._id=p,n&&(this._id=n),this.name=p,this.album=e}}class W{constructor(p,e,n){this.name=e,this.artists=[{name:p}],this.images=[{url:n}]}}var t=b(4650),N=b(8672),R=b(7556),M=b(7423),Q=b(76);const f=(0,M.fo)("Camera",{web:()=>b.e(3954).then(b.bind(b,3954)).then(o=>new o.CameraWeb)});let c=(()=>{class o{constructor(){}takePictureBase64(){return(0,l.Z)(function*(){const e=yield f.getPhoto({quality:100,allowEditing:!1,resultType:Q.dk.Base64});if(e&&e.base64String)return e.base64String})()}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function _(o,p){1&o&&(t.TgZ(0,"div",21)(1,"ion-label"),t._uU(2,"B\xfasqueda en Spotify"),t.qZA()())}function k(o,p){if(1&o&&(t.TgZ(0,"ion-segment-button",24),t._uU(1),t.qZA()),2&o){const e=p.$implicit,n=p.index,a=t.oxw(2);t.Q6J("value",a.searchFiltersKeys[n]),t.xp6(1),t.hij(" ",e," ")}}function O(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-segment",22),t.NdJ("ionChange",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.changeParams())})("ngModelChange",function(a){t.CHM(e);const u=t.oxw();return t.KtG(u.filter=a)}),t.YNc(1,k,2,2,"ion-segment-button",23),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("scrollable",!0)("ngModel",e.filter),t.xp6(1),t.Q6J("ngForOf",e.searchFiltersValues)}}function ft(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-button",9),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.toggleInsertTrack())}),t._UZ(1,"ion-icon",29),t.qZA()}}function tt(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-button",9),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.toggleInsertTrack())}),t._UZ(1,"ion-icon",30),t.qZA()}}function et(o,p){if(1&o&&(t.TgZ(0,"ion-buttons",25),t.YNc(1,ft,2,0,"ion-fab-button",26),t.YNc(2,tt,2,0,"ion-fab-button",26),t.TgZ(3,"ion-fab-button",27),t._UZ(4,"ion-icon",28),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.toggleInsert),t.xp6(1),t.Q6J("ngIf",e.toggleInsert)}}function ot(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",31),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.insertTracks())}),t._UZ(1,"ion-icon",32),t._uU(2),t.qZA()}if(2&o){const e=t.oxw();t.xp6(2),t.hij(" A\xf1adir ",e.tracksToBeAdded.length," canciones ")}}function _t(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-label",37),t._uU(2,"URL imagen"),t.qZA(),t.TgZ(3,"ion-input",45),t.NdJ("ngModelChange",function(a){t.CHM(e);const u=t.oxw(2);return t.KtG(u.trackToAdd.album.images[0].url=a)}),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("ngModel",e.trackToAdd.album.images[0].url)}}function it(o,p){1&o&&t._UZ(0,"ion-img",51)}function at(o,p){if(1&o&&t._UZ(0,"ion-img",19),2&o){const e=t.oxw(3);t.Q6J("src","data:image/jpeg;base64,"+e.trackToAdd.album.images[0].imageBase64String)}}function st(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"div",46),t.YNc(1,it,1,0,"ion-img",47),t.YNc(2,at,1,1,"ion-img",48),t.TgZ(3,"ion-fab",49)(4,"ion-fab-button",34),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.takePicture())}),t._UZ(5,"ion-icon",50),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.trackToAdd.album.images[0].imageBase64String),t.xp6(1),t.Q6J("ngIf",e.trackToAdd.album.images[0].imageBase64String)}}function ct(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3,"A\xf1adir canci\xf3n"),t.qZA(),t.TgZ(4,"ion-buttons",33)(5,"ion-button",34),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.cancel())}),t._uU(6,"Cancelar"),t.qZA(),t.TgZ(7,"ion-button",35),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.confirm(a.trackToAdd))}),t._uU(8,"A\xf1adir"),t.qZA()()()(),t.TgZ(9,"ion-content",36)(10,"ion-item")(11,"ion-label",37),t._uU(12,"Nombre"),t.qZA(),t.TgZ(13,"ion-input",38),t.NdJ("ngModelChange",function(a){t.CHM(e);const u=t.oxw();return t.KtG(u.trackToAdd.name=a)}),t.qZA()(),t.TgZ(14,"ion-item")(15,"ion-label",37),t._uU(16,"Artista/Grupo"),t.qZA(),t.TgZ(17,"ion-input",39),t.NdJ("ngModelChange",function(a){t.CHM(e);const u=t.oxw();return t.KtG(u.trackToAdd.album.artists[0].name=a)}),t.qZA()(),t.TgZ(18,"ion-segment",40),t.NdJ("ngModelChange",function(a){t.CHM(e);const u=t.oxw();return t.KtG(u.togglePhoto=a)}),t.TgZ(19,"ion-segment-button",41)(20,"ion-label"),t._uU(21,"URL"),t.qZA()(),t.TgZ(22,"ion-segment-button",42)(23,"ion-label"),t._uU(24,"Imagen"),t.qZA()()(),t.YNc(25,_t,4,1,"ion-item",43),t.YNc(26,st,6,2,"div",44),t.qZA()}if(2&o){const e=t.oxw();t.xp6(7),t.Q6J("strong",!0),t.xp6(6),t.Q6J("ngModel",e.trackToAdd.name),t.xp6(4),t.Q6J("ngModel",e.trackToAdd.album.artists[0].name),t.xp6(1),t.Q6J("ngModel",e.togglePhoto),t.xp6(7),t.Q6J("ngIf","url"===e.togglePhoto),t.xp6(1),t.Q6J("ngIf","img"===e.togglePhoto)}}function lt(o,p){1&o&&t._UZ(0,"ion-icon",64)}function mt(o,p){1&o&&t._UZ(0,"ion-icon",65)}function s(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-button",61),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,u=t.oxw(),x=t.MAs(26);return t.KtG(x.src!==a.preview_url?u.changePreview(x,a.preview_url):u.changePreview(x))}),t.YNc(1,lt,1,0,"ion-icon",62),t.YNc(2,mt,1,0,"ion-icon",63),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.oxw();const n=t.MAs(26);t.xp6(1),t.Q6J("ngIf",n.src!==e.preview_url),t.xp6(1),t.Q6J("ngIf",n.src===e.preview_url)}}function r(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-button",9),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,u=t.oxw();return t.KtG(u.tracksToBeAdded.push(a))}),t._UZ(1,"ion-icon",28),t.qZA()}}function i(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-button",66),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,u=t.oxw();return t.KtG(u.tracksToBeAdded.splice(u.tracksToBeAdded.indexOf(a),1))}),t._UZ(1,"ion-icon",67),t.qZA()}}function g(o,p){1&o&&(t.TgZ(0,"ion-fab-button",68),t._UZ(1,"ion-icon",69),t.qZA())}function h(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-list")(1,"ion-fab-button")(2,"ion-icon",70),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,u=t.oxw();return t.KtG(u.navigateToTrackEdit(a._id))}),t.qZA()(),t.TgZ(3,"ion-fab-button",71),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,u=t.oxw();return t.KtG(u.handleDeleteAlert(a._id))}),t._UZ(4,"ion-icon",72),t.qZA()()}}function d(o,p){if(1&o&&t._UZ(0,"ion-img",19),2&o){const e=t.oxw().$implicit;t.s9C("src",e.album.images[1].url)}}function T(o,p){if(1&o&&t._UZ(0,"ion-img",19),2&o){const e=t.oxw().$implicit;t.s9C("src",e.album.images[0].url)}}function m(o,p){if(1&o&&t._UZ(0,"ion-img",19),2&o){const e=t.oxw().$implicit;t.Q6J("src","data:image/jpeg;base64,"+e.album.images[0].imageBase64String)}}function C(o,p){if(1&o&&(t.TgZ(0,"div")(1,"ion-label"),t._uU(2),t.qZA()()),2&o){const e=p.$implicit;t.xp6(2),t.Oqu(e.name)}}function P(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"ion-card",52),t.YNc(1,s,3,2,"ion-fab-button",53),t.TgZ(2,"ion-fab"),t.YNc(3,r,2,0,"ion-fab-button",26),t.YNc(4,i,2,0,"ion-fab-button",54),t.YNc(5,g,2,0,"ion-fab-button",55),t.YNc(6,h,5,0,"ion-fab-list",43),t.qZA(),t.TgZ(7,"div",56),t.NdJ("click",function(){const u=t.CHM(e).$implicit,x=t.oxw();return t.KtG(!x.toggleInsert&&x.navigateToTrack(u._id))}),t.TgZ(8,"section",57),t.YNc(9,d,1,1,"ion-img",48),t.YNc(10,T,1,1,"ion-img",48),t.YNc(11,m,1,1,"ion-img",48),t.qZA(),t.TgZ(12,"section",58)(13,"article")(14,"div")(15,"p"),t._uU(16),t.qZA()()(),t.TgZ(17,"article")(18,"ion-grid")(19,"ion-row",16),t.YNc(20,C,3,1,"div",59),t.qZA()()(),t.TgZ(21,"article")(22,"div",60)(23,"p"),t._uU(24),t.ALo(25,"date"),t.qZA()()()()()()}if(2&o){const e=p.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngIf",e.preview_url),t.xp6(2),t.Q6J("ngIf",n.toggleInsert&&!n.tracksToBeAdded.includes(e)),t.xp6(1),t.Q6J("ngIf",n.toggleInsert&&n.tracksToBeAdded.includes(e)),t.xp6(1),t.Q6J("ngIf",!n.toggleInsert&&n.displayInsert),t.xp6(1),t.Q6J("ngIf",!n.toggleInsert&&n.displayInsert),t.xp6(3),t.Q6J("ngIf",e.album.images[1]),t.xp6(1),t.Q6J("ngIf",!e.album.images[1]&&e.album.images[0].url),t.xp6(1),t.Q6J("ngIf",e.album.images[0].imageBase64String),t.xp6(5),t.Oqu(e.name),t.xp6(4),t.Q6J("ngForOf",e.album.artists),t.xp6(4),t.hij("",t.xi3(25,11,e.duration_ms,"mm:ss")," min")}}var $=(()=>{return(o=$||($={})).name="Nombre",o.artist="Artista",o.date="Fecha",$;var o})();const D=[{path:"",component:(()=>{class o{constructor(e,n,a,u,x,B,dt){this.apiService=e,this.route=n,this.authService=a,this.router=u,this.alertCtrl=x,this.toastCtrl=B,this.cameraService=dt,this.toggleInsert=!1,this.displayInsert=!1,this.searchFiltersValues=Object.values($),this.searchFiltersKeys=Object.keys($),this.filter=this.searchFiltersKeys[0],this.trackToAdd=new X("",new W("","","")),this.togglePhoto="url",this.tracksToBeAdded=[],this.offset=0,this.route.queryParams.subscribe(V=>{this.displayInsert=this.authService.checkLogged(),this.query=V.s,Object.keys($).includes(V.f)&&(this.filter=V.f),this.search()})}changePreview(e,n){n?e.src=n:(e.src="",e.removeAttribute("src")),e.play()}handleDeleteAlert(e){this.alertCtrl.create({header:"Confirmar eliminaci\xf3n",message:"\xbfEst\xe1s seguro de que quieres eliminar esta canci\xf3n?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"confirm",handler:()=>{var n;this.deleteTrack(e),this.tracks=null===(n=this.tracks)||void 0===n?void 0:n.filter(a=>a._id!=e)}}]}).then(n=>n.present())}cancel(){this.modal&&this.modal.dismiss(null,"cancel")}confirm(e){this.modal&&this.modal.dismiss(e,"confirm")}onWillDismiss(e){const n=e;var a;"confirm"===n.detail.role&&n.detail.data&&(n.detail.data._id=null===(a=n.detail.data)||void 0===a?void 0:a.name,"url"==this.togglePhoto&&(n.detail.data.album.images[0].imageBase64String=void 0),"img"==this.togglePhoto&&(n.detail.data.album.images[0].url=void 0),this.insertTrack(n.detail.data))}changeParams(){let e={s:this.query,f:this.filter};""==this.query&&(e.s=void 0),this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge"})}navigateToTrack(e){this.router.navigate([`/tracks/${e}`])}navigateToTrackEdit(e){this.router.navigate([`/tracks/${e}/edit`])}toggleInsertTrack(){this.toggleInsert=!this.toggleInsert,this.search()}search(){this.changeParams(),this.query?this.toggleInsert?this.searchSpotify(this.query):this.searchDB(this.query):this.toggleInsert?this.tracks=[]:this.getAllTracks()}searchSpotify(e){var n=this;return(0,l.Z)(function*(){const a=yield n.apiService.searchTracksSpotify(e),u=yield n.apiService.getTracks();n.offset=0;for(let x of a)x.inserted=!!u.find(B=>B._id==x._id);n.tracks=a.filter(x=>0==x.inserted)})()}paginationSpotify(e){var n=this;return(0,l.Z)(function*(){n.offset+=20;const a=yield n.apiService.searchTracksSpotify(e,n.offset),u=yield n.apiService.getTracks();for(let x of a)x.inserted=!!u.find(B=>B._id==x._id);return a.filter(x=>0==x.inserted)})()}onIonInfinite(e){var n=this;const a=e.target;console.log(this.offset),setTimeout((0,l.Z)(function*(){if(n.query){var u;const x=yield n.paginationSpotify(n.query);n.tracks=null===(u=n.tracks)||void 0===u?void 0:u.concat(x)}a.complete()}),500)}searchDB(e){var n=this;return(0,l.Z)(function*(){try{n.tracks=yield n.apiService.searchTracks(e,n.filter)}catch(a){a instanceof Error&&console.error(a.message)}})()}getAllTracks(){var e=this;return(0,l.Z)(function*(){try{e.tracks=yield e.apiService.getTracks()}catch(n){n instanceof Error&&console.error(n.message)}})()}insertTrack(e){var n=this;return(0,l.Z)(function*(){var a;yield n.apiService.insertTrack(e),n.tracks=null===(a=n.tracks)||void 0===a?void 0:a.filter(u=>u._id!=e._id),n.toastCtrl.create({message:"Canci\xf3n insertada correctamente",duration:2e3}).then(u=>u.present()),n.search()})()}insertTracks(){var e=this;return(0,l.Z)(function*(){0!=e.tracksToBeAdded.length&&(yield e.apiService.insertTracks(e.tracksToBeAdded),e.tracksToBeAdded=[],e.toastCtrl.create({message:"Canciones insertadas correctamente",duration:2e3}).then(n=>n.present()),e.query="",e.toggleInsertTrack())})()}deleteTrack(e){var n=this;return(0,l.Z)(function*(){console.log("deleteTrack: "+e),(yield n.apiService.deleteTrack(e))?n.toastCtrl.create({message:"Canci\xf3n eliminada correctamente",duration:2e3}).then(u=>u.present()):n.toastCtrl.create({message:"No se ha podido eliminar la canci\xf3n",duration:2e3}).then(u=>u.present())})()}takePicture(){var e=this;return(0,l.Z)(function*(){const n=yield e.cameraService.takePictureBase64();n&&(e.trackToAdd.album.images[0]={imageBase64String:n})})()}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(N.j),t.Y36(A.gz),t.Y36(R.e),t.Y36(A.F0),t.Y36(v.Br),t.Y36(v.yF),t.Y36(c))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-tracks"]],viewQuery:function(e,n){if(1&e&&t.Gf(v.ki,5),2&e){let a;t.iGM(a=t.CRH())&&(n.modal=a.first)}},standalone:!0,features:[t.jDz],decls:27,vars:8,consts:[[1,"ion-no-border"],["id","top-toolbar"],["slot","start"],["defaultHref","/"],["class","ion-text-center",4,"ngIf"],[3,"scrollable","ngModel","ionChange","ngModelChange",4,"ngIf"],["id","bottom-toolbar"],["id","searchBar"],["mode","ios","placeholder","Introduce el nombre de la canci\xf3n",3,"ngModel","keyup.enter","ngModelChange"],["size","small",3,"click"],["name","search"],["slot","end","id","displayInsert",4,"ngIf"],["id","addTracks","color","success","shape","round",3,"click",4,"ngIf"],["id","container"],["trigger","open-modal",3,"willDismiss"],[3,"fixed"],[1,"ion-justify-content-center"],["button","","class","card",4,"ngFor","ngForOf"],[3,"ionInfinite"],[3,"src"],["ref",""],[1,"ion-text-center"],[3,"scrollable","ngModel","ionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["slot","end","id","displayInsert"],["size","small",3,"click",4,"ngIf"],["id","open-modal","size","small"],["name","add"],["name","arrow-down"],["name","list"],["id","addTracks","color","success","shape","round",3,"click"],["name","checkmark"],["slot","end"],[3,"click"],["color","primary",3,"strong","click"],[1,"ion-padding"],["position","stacked"],["type","text","aria-label","Nombre","placeholder","Nombre de la canci\xf3n",3,"ngModel","ngModelChange"],["type","text","aria-label","Artista","placeholder","Artista o grupo",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["value","url"],["value","img"],[4,"ngIf"],["style","padding: 45px 0;",4,"ngIf"],["type","text","aria-label","URL","placeholder","URL de la imagen",3,"ngModel","ngModelChange"],[2,"padding","45px 0"],["src","../../../assets/placeholder.png",4,"ngIf"],[3,"src",4,"ngIf"],["vertical","bottom","horizontal","center","slot","fixed"],["name","camera"],["src","../../../assets/placeholder.png"],["button","",1,"card"],["size","small","class","playButton",3,"click",4,"ngIf"],["color","danger","size","small",3,"click",4,"ngIf"],["size","small","color","light",4,"ngIf"],[1,"card",3,"click"],["id","img-container"],["id","card-info"],[4,"ngFor","ngForOf"],["id","shadow"],["size","small",1,"playButton",3,"click"],["name","play",4,"ngIf"],["name","pause",4,"ngIf"],["name","play"],["name","pause"],["color","danger","size","small",3,"click"],["name","close"],["size","small","color","light"],["name","ellipsis-vertical"],["name","pencil",3,"click"],["id","delete-alert",3,"click"],["name","trash","color","danger"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-content")(1,"ion-header",0)(2,"ion-toolbar",1)(3,"ion-buttons",2),t._UZ(4,"ion-back-button",3),t.qZA(),t.TgZ(5,"ion-title"),t.YNc(6,_,3,0,"div",4),t.YNc(7,O,2,3,"ion-segment",5),t.qZA()(),t.TgZ(8,"ion-toolbar",6)(9,"ion-title")(10,"div",7)(11,"ion-searchbar",8),t.NdJ("keyup.enter",function(){return n.search()})("ngModelChange",function(u){return n.query=u}),t.qZA(),t.TgZ(12,"ion-buttons")(13,"ion-fab-button",9),t.NdJ("click",function(){return n.search()}),t._UZ(14,"ion-icon",10),t.qZA()()()(),t.YNc(15,et,5,2,"ion-buttons",11),t.qZA(),t.YNc(16,ot,3,1,"ion-button",12),t.qZA(),t.TgZ(17,"div",13)(18,"ion-modal",14),t.NdJ("willDismiss",function(u){return n.onWillDismiss(u)}),t.YNc(19,ct,27,6,"ng-template"),t.qZA(),t.TgZ(20,"ion-grid",15)(21,"ion-row",16),t.YNc(22,P,26,14,"ion-card",17),t.qZA(),t.TgZ(23,"ion-infinite-scroll",18),t.NdJ("ionInfinite",function(u){return n.onIonInfinite(u)}),t._UZ(24,"ion-infinite-scroll-content"),t.qZA()()(),t._UZ(25,"audio",19,20),t.qZA()),2&e&&(t.xp6(6),t.Q6J("ngIf",n.toggleInsert),t.xp6(1),t.Q6J("ngIf",!n.toggleInsert),t.xp6(4),t.Q6J("ngModel",n.query),t.xp6(4),t.Q6J("ngIf",n.displayInsert),t.xp6(1),t.Q6J("ngIf",n.toggleInsert&&0!==n.tracksToBeAdded.length),t.xp6(4),t.Q6J("fixed",!0),t.xp6(2),t.Q6J("ngForOf",n.tracks),t.xp6(3),t.Q6J("src",n.previewToPlay,t.LSH))},dependencies:[y.ez,y.sg,y.O5,y.uU,w.u5,w.JJ,w.On,v.Pc,v.oU,v.YG,v.Sm,v.PM,v.W2,v.IJ,v.W4,v.zq,v.jY,v.Gu,v.gu,v.Xz,v.ju,v.MB,v.pK,v.Ie,v.Q$,v.Nd,v.VI,v.cJ,v.GO,v.wd,v.sr,v.ki,v.QI,v.j9,v.cs,A.Bz],styles:['ion-card[_ngcontent-%COMP%]{width:200px;position:relative;height:300px;background-color:#000;transition:.5s}ion-card[_ngcontent-%COMP%]:hover{transform:scale(1.1)}ion-img[_ngcontent-%COMP%]{height:100%;aspect-ratio:1/1}ion-card[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{position:absolute;z-index:1;top:0;right:0}ion-fab-button[_ngcontent-%COMP%]{--box-shadow: none}#top-toolbar[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{position:absolute}ion-segment-button[_ngcontent-%COMP%]{width:100px}#img-container[_ngcontent-%COMP%]{position:relative}#img-container[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;top:0;width:100%;height:100%;background:linear-gradient(to bottom,rgba(255,255,255,0) 0,black 100%)}#card-info[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}#shadow[_ngcontent-%COMP%]{box-shadow:0 -32px 222px 112px var(--ion-color-primary);position:relative;z-index:0!important}#card-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:relative;background-color:#000;color:#fff;text-align:center;border-radius:5px;margin:0 auto;width:max-content;padding:0 10px;max-width:92%;z-index:1}#card-info[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin:2px}#searchBar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}#searchBar[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{padding:0;max-width:328px}#searchBar[_ngcontent-%COMP%]{padding:0}ion-segment[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;margin:0 auto}ion-modal[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:45%;margin:0 auto}#addTracks[_ngcontent-%COMP%]{position:fixed;top:62px;right:20px;z-index:10}.playButton[_ngcontent-%COMP%]{position:absolute;z-index:100;opacity:0;transition:opacity .3s ease-in-out}.card[_ngcontent-%COMP%]:hover   .playButton[_ngcontent-%COMP%]{opacity:1}#displayInsert[_ngcontent-%COMP%]{right:0}#displayInsert[_ngcontent-%COMP%]{position:absolute}@media (max-width: 1075px){#addTracks[_ngcontent-%COMP%]{bottom:50px;right:50px;top:unset}}@media (max-width: 625px){#displayInsert[_ngcontent-%COMP%]{position:relative}ion-title[_ngcontent-%COMP%]{padding-right:0}}@media (max-width: 768px){ion-modal[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:90%;margin:0 auto}}@media (max-width: 768px) and (max-width: 425px){ion-card[_ngcontent-%COMP%]{width:150px;height:245px}}@media (max-width: 768px) and (max-width: 425px) and (max-width: 350px){ion-card[_ngcontent-%COMP%]{width:90%;height:215px}}']}),o})()},{path:":id",loadComponent:()=>b.e(6845).then(b.bind(b,6845)).then(o=>o.TrackPage)},{path:":id/edit",loadComponent:()=>b.e(9077).then(b.bind(b,9077)).then(o=>o.EditPage)}]},8672:(rt,F,b)=>{b.d(F,{j:()=>R});var l=b(5861),y=b(529),w=b(9808),A=b(2340),v=b(4650),X=b(7556);const t=(0,b(7423).fo)("Geolocation",{web:()=>b.e(4561).then(b.bind(b,4561)).then(M=>new M.GeolocationWeb)});let N=(()=>{class M{constructor(){this.coords={latitude:0,longitude:0,accuracy:0}}getLocation(){var f=this;return(0,l.Z)(function*(){const c=yield t.getCurrentPosition();return f.coords.latitude=c.coords.latitude,f.coords.latitude=c.coords.longitude,f.coords.accuracy=c.coords.accuracy,f.coords})()}}return M.\u0275fac=function(f){return new(f||M)},M.\u0275prov=v.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),R=(()=>{class M{constructor(f,c,_){this.http=f,this.authService=c,this.geoService=_,this.url=A.N.url,this.token=this.authService.getJWT()}searchTracksSpotify(f,c=0){var _=this;return(0,l.Z)(function*(){try{return(yield(0,w.n)(_.http.get(`${_.url}search/${encodeURI(f)}?offset=${c}`))).tracks.items.map(O=>({_id:O.id,...O,id:void 0}))}catch(k){return console.log(k),[]}})()}searchTracks(f,c="name"){var _=this;return(0,l.Z)(function*(){try{return yield(0,w.n)(_.http.get(`${_.url}tracks/search?${c}=${encodeURI(f)}`,{headers:{Authorization:`Bearer ${_.token}`}}))}catch(k){if(k instanceof y.UA){if(404===k.status)throw new Error("Track not found");if(500===k.status)throw new Error("Error getting track");if(0===k.status)throw new Error("Error connecting to server")}throw k}})()}getTrack(f){var c=this;return(0,l.Z)(function*(){try{return yield(0,w.n)(c.http.get(`${c.url}tracks/${f}`,{headers:{Authorization:`Bearer ${c.token}`}}))}catch(_){if(_ instanceof y.UA){if(404===_.status)throw new Error("Track not found");if(500===_.status)throw new Error("Error getting track");if(0===_.status)throw new Error("Error connecting to server")}throw _}})()}getTracks(){var f=this;return(0,l.Z)(function*(){try{return yield(0,w.n)(f.http.get(`${f.url}tracks/`,{headers:{Authorization:`Bearer ${f.token}`}}))}catch(c){if(c instanceof y.UA){if(500===c.status)throw new Error("Error getting track");if(0===c.status)throw new Error("Error connecting to server")}}return[]})()}insertTrack(f){var c=this;return(0,l.Z)(function*(){let _;try{_=yield c.geoService.getLocation()}catch(O){O instanceof GeolocationPositionError&&console.log("Error getting location")}f.location=_;const k=[f];try{return yield(0,w.n)(c.http.post(`${c.url}tracks/`,k,{headers:{Authorization:`Bearer ${c.token}`}})),!0}catch(O){if(O instanceof y.UA&&400===O.status)throw Error("Track already exists");return!1}})()}insertTracks(f){var c=this;return(0,l.Z)(function*(){let _;try{_=yield c.geoService.getLocation()}catch(k){k instanceof GeolocationPositionError&&console.log("Error getting location")}_&&f.forEach(k=>k.location=_);try{return yield(0,w.n)(c.http.post(`${c.url}tracks/`,f,{headers:{Authorization:`Bearer ${c.token}`}})),!0}catch(k){if(k instanceof y.UA&&400===k.status)throw Error("Track already exists");return!1}})()}insertComment(f,c){var _=this;return(0,l.Z)(function*(){let k;try{k=yield _.geoService.getLocation()}catch(O){O instanceof GeolocationPositionError&&console.log("Error getting location")}c.location=k,console.log(c);try{return yield(0,w.n)(_.http.post(`${_.url}tracks/${f}/comments`,c,{headers:{Authorization:`Bearer ${_.token}`}})),!0}catch(O){return O instanceof y.UA&&404===O.status&&console.log("Track not found"),!1}})()}updateTrack(f){var c=this;return(0,l.Z)(function*(){try{return yield(0,w.n)(c.http.put(`${c.url}tracks/${f._id}`,f,{headers:{Authorization:`Bearer ${c.token}`}})),!0}catch(_){return _ instanceof y.UA&&(404===_.status&&console.log("Track not found"),500===_.status&&console.log("Error updating track")),!1}})()}deleteTrack(f){var c=this;return(0,l.Z)(function*(){try{return yield(0,w.n)(c.http.delete(`${c.url}tracks/${f}`,{headers:{Authorization:`Bearer ${c.token}`}})),!0}catch(_){return _ instanceof y.UA&&(404===_.status&&console.log("Track not found"),500===_.status&&console.log("Error deleting track")),!1}})()}getComments(f){var c=this;return(0,l.Z)(function*(){let _=[];try{_=yield(0,w.n)(c.http.get(`${c.url}tracks/${f}/comments`,{headers:{Authorization:`Bearer ${c.token}`}})),console.log(_)}catch(k){k instanceof y.UA&&(404===k.status&&console.log("Track not found"),500===k.status&&console.log("Error getting comments"))}return _})()}deleteComment(f,c){var _=this;return(0,l.Z)(function*(){try{return yield(0,w.n)(_.http.delete(`${_.url}tracks/${f}/comments/${c}`,{headers:{Authorization:`Bearer ${_.token}`}})),!0}catch(k){return k instanceof y.UA&&(404===k.status&&console.log("Track not found"),500===k.status&&console.log("Error deleting comment")),!1}})()}}return M.\u0275fac=function(f){return new(f||M)(v.LFG(y.eN),v.LFG(X.e),v.LFG(N))},M.\u0275prov=v.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})()}}]);